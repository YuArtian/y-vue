{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["\nexport function isObject (data) {\n  return typeof data === 'object' && data !== null\n}\n//将属性变为不可枚举的\nexport function def(data, key, value){\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    value,\n  })\n}","\n\nconst oldArrayMethods = Array.prototype\n// data.__proto__ = arrayMethods\n// arrayMethods.__proto__ = oldArrayMethods = Array.prototype 利用原型链的查找，进行函数劫持\nexport const arrayMethods = Object.create(oldArrayMethods)\n//重写 7 个可以改变数组本身的方法 pop、shift、unshift、push、reverse、splice、sort\nconst methods = ['pop','shift','unshift','push','reverse','splice','sort']\n\nmethods.forEach(method => {\n  arrayMethods[method] = function(...args){\n    //AOP 切片编程\n    console.log('用户改变了数组')\n    const result = oldArrayMethods[method].apply(this, args)\n    //如果插入的元素是对象\n    let inserted\n    //拿到实例\n    let ob = this.__ob__;\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break;\n      case 'splice':\n        inserted = args.slice(2)\n        break;\n      default:\n        break;\n    }\n    if (inserted) {\n      //继续观测新增的属性\n      ob.observeArray(inserted)\n    }\n    return result\n  }\n})","import { isObject, def } from '../util/index'\nimport { arrayMethods } from './array'\n\nclass Observer {\n  constructor(data){\n    //会引发死循环\n    // data.__ob__ = this;\n    def(data, '__ob__', this)\n    if (Array.isArray(data)) {\n      //重写数组的部分方法\n      data.__proto__ = arrayMethods\n      //数组的劫持 只劫持数组中的 对象\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  walk(data){\n    let keys = Object.keys(data)\n    keys.forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  //处理数组\n  observeArray(data){\n    data.forEach(value => {\n      observe(value)\n    })\n  }\n}\n\nfunction defineReactive(data, key, value){\n  observe(value)\n  Object.defineProperty(data, key, {\n    get(){\n      return value\n    },\n    set(newValue){\n      if (newValue === value) return\n      observe(newValue)\n      console.log('值发生变化了')\n      value = newValue\n    }\n  })\n}\n\n// Object.defineProperty 不兼容 ie8\nexport function observe (data) {\n  if (!isObject(data)) {\n    return\n  }\n  new Observer(data)\n}","import { observe } from './observer/index'\n\nexport function initState (vm) {\n  const opts = vm.$options\n  //vue 的数据来源 属性 方法 数据 计算属性 watch\n  //初始化 属性\n  if (opts.props) {\n    initProps(vm)\n  }\n  //初始化 方法\n  if (opts.methods) {\n    initMethod(vm)\n  }\n  //初始化 数据\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n}\n\n\nfunction initProps(){}\nfunction initMethod(){}\n\nfunction initData(vm){\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n\n  //数据劫持\n  observe(data);\n\n}\n\nfunction initComputed(){}\nfunction initWatch(){}","import { initState } from './state'\n\nexport function initMixin(Vue){\n  //初始化\n  Vue.prototype._init = function(options){\n    //数据劫持\n    const vm = this\n    vm.$options = options\n    //初始化状态\n    initState(vm)\n\n    //如果用户传入了 el\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n\n  //挂载\n\n}","import { initMixin } from './init'\n\nfunction Vue (options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","console","log","args","result","apply","inserted","ob","__ob__","slice","observeArray","Observer","isArray","__proto__","walk","keys","defineReactive","observe","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options","el","$mount"],"mappings":"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"}